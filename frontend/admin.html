<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin - Gestion Utilisateurs</title>
    <link rel="stylesheet" href="styles.css">
</head>

<body>

    <header>
        <h1>Prédiction de l’Obésité - Espace Administrateur</h1>
        <nav>
            <a href="dashboard.html">Tableau de bord</a>
            <a href="index.html" onclick="logout()">Déconnexion</a>
        </nav>
    </header>

    <main>
        <h2>Liste des utilisateurs</h2>

        <!-- Filtre par date -->
        <label for="filter-date">Filtrer par date de création :</label>
        <input type="date" id="filter-date">

        <!-- Tableau des utilisateurs -->
        <table id="users-table">
            <thead>
                <tr>
                    <th>ID</th>
                    <th>Nom</th>
                    <th>Email</th>
                    <th>Rôle</th>
                    <th>Date création</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
                <!-- rempli dynamiquement via app.js -->
            </tbody>
        </table>

        <!-- Pagination -->
        <div style="margin-top: 15px; display: flex; justify-content: space-between; align-items: center;">
            <button id="prev-page">Précédent</button>
            <span id="page-info"></span>
            <button id="next-page">Suivant</button>
        </div>

    </main>
    <script>
        // Exemple de données utilisateurs
        const users = [
            { id: 1, name: "Alice", email: "alice@example.com", role: "admin", created_at: "2025-01-12" },
            { id: 2, name: "Bob", email: "bob@example.com", role: "user", created_at: "2025-03-05" },
            { id: 3, name: "Charlie", email: "charlie@example.com", role: "user", created_at: "2025-04-18" },
            { id: 4, name: "David", email: "david@example.com", role: "user", created_at: "2025-06-09" },
            { id: 5, name: "Eva", email: "eva@example.com", role: "admin", created_at: "2025-02-28" },
            { id: 6, name: "Frank", email: "frank@example.com", role: "user", created_at: "2025-05-12" },
            { id: 7, name: "Grace", email: "grace@example.com", role: "user", created_at: "2025-07-01" },
            { id: 8, name: "Hannah", email: "hannah@example.com", role: "user", created_at: "2025-03-21" },
            { id: 9, name: "Ian", email: "ian@example.com", role: "user", created_at: "2025-04-10" },
            { id: 10, name: "Julia", email: "julia@example.com", role: "admin", created_at: "2025-06-25" }
        ];

        let currentPage = 1;
        const rowsPerPage = 5;

        const tableBody = document.querySelector("#users-table tbody");
        const pageInfo = document.getElementById("page-info");
        const filterDate = document.getElementById("filter-date");

        function renderTable() {
            tableBody.innerHTML = "";
            let filteredUsers = users;

            // Filtrer par date si sélectionnée
            if (filterDate.value) {
                filteredUsers = users.filter(u => u.created_at === filterDate.value);
            }

            const start = (currentPage - 1) * rowsPerPage;
            const end = start + rowsPerPage;
            const pageUsers = filteredUsers.slice(start, end);

            for (const user of pageUsers) {
                const tr = document.createElement("tr");
                tr.innerHTML = `
        <td>${user.id}</td>
        <td>${user.name}</td>
        <td>${user.email}</td>
        <td>${user.role}</td>
        <td>${user.created_at}</td>
        <td>
          <button onclick="editUser(${user.id})">✏️ Éditer</button>
          <button onclick="deleteUser(${user.id})">🗑️ Supprimer</button>
        </td>
      `;
                tableBody.appendChild(tr);
            }

            // Mise à jour de la pagination
            const totalPages = Math.ceil(filteredUsers.length / rowsPerPage) || 1;
            pageInfo.textContent = `Page ${currentPage} / ${totalPages}`;
        }

        function nextPage() {
            const totalPages = Math.ceil(users.length / rowsPerPage);
            if (currentPage < totalPages) {
                currentPage++;
                renderTable();
            }
        }

        function prevPage() {
            if (currentPage > 1) {
                currentPage--;
                renderTable();
            }
        }

        // Boutons pagination
        document.getElementById("next-page").addEventListener("click", nextPage);
        document.getElementById("prev-page").addEventListener("click", prevPage);

        // Filtrage dynamique
        filterDate.addEventListener("change", () => {
            currentPage = 1; // revenir à la première page
            renderTable();
        });

        // Fonctions fictives pour actions
        function editUser(id) {
            alert("Éditer l'utilisateur ID " + id);
        }

        function deleteUser(id) {
            if (confirm("Voulez-vous vraiment supprimer cet utilisateur ?")) {
                const index = users.findIndex(u => u.id === id);
                if (index !== -1) {
                    users.splice(index, 1);
                    renderTable();
                }
            }
        }

        // Initialiser la table
        renderTable();
    </script>

    <footer>
        © 2025 Prédiction de l’Obésité. Tous droits réservés.
    </footer>

    <script src="js/app.js"></script>

</body>

</html>