<!DOCTYPE html>
<html lang="fr">

<head>
  <meta charset="UTF-8">
  <title>Tableau de bord - D√©tection Diab√®te</title>
  <link rel="stylesheet" href="styles.css">
</head>

<body>
  <body>
  <header>
    <h1>Mon Tableau de Bord</h1>
    <nav>
      <a href="add_patient.html">Nouvelle Pr√©diction</a>
      <a href="index.html" onclick="logout()">D√©connexion</a>
    </nav>
  </header>

  <main>
    <h2>Historique de mes pr√©dictions</h2>
    <table id="history-table">
      <thead>
        <tr>
          <th>Date</th>
          <th>√Çge</th>
          <th>FCVC</th>
          <th>R√©sultat</th>
          <th>Probabilit√©</th>
        </tr>
      </thead>
      <tbody>
        <!-- rempli par app.js -->
      </tbody>
    </table>

    <!-- Section Graphiques -->
    <section style="margin-top:40px;">
      <h2>üìä Statistiques</h2>
      <canvas id="chartResults" width="400" height="200"></canvas>
      <canvas id="chartProbabilities" width="400" height="200" style="margin-top:30px;"></canvas>
    </section>
  </main>

  <!-- Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

  <script>
    // Exemple de donn√©es de pr√©dictions
    const predictions = [
      { date: "2025-01-12", age: 25, fcvc: 2, result: "Sain", probability: 0.85 },
      { date: "2025-02-18", age: 40, fcvc: 1, result: "Surpoids", probability: 0.67 },
      { date: "2025-03-03", age: 32, fcvc: 3, result: "Ob√®se", probability: 0.92 },
      { date: "2025-03-22", age: 28, fcvc: 2, result: "Sain", probability: 0.78 },
      { date: "2025-04-10", age: 35, fcvc: 1, result: "Surpoids", probability: 0.59 },
      { date: "2025-04-25", age: 45, fcvc: 3, result: "Ob√®se", probability: 0.95 },
      { date: "2025-05-15", age: 30, fcvc: 2, result: "Sain", probability: 0.88 },
      { date: "2025-05-30", age: 50, fcvc: 1, result: "Surpoids", probability: 0.70 },
      { date: "2025-06-05", age: 38, fcvc: 3, result: "Ob√®se", probability: 0.91 },
      { date: "2025-06-20", age: 27, fcvc: 2, result: "Sain", probability: 0.82 }
    ];

    const tableBody = document.querySelector("#history-table tbody");

    function renderHistory() {
      tableBody.innerHTML = "";
      for (const pred of predictions) {
        const tr = document.createElement("tr");
        tr.innerHTML = `
          <td>${pred.date}</td>
          <td>${pred.age}</td>
          <td>${pred.fcvc}</td>
          <td class="${pred.result === 'Ob√®se' ? 'result-1' : 'result-0'}">${pred.result}</td>
          <td>${(pred.probability * 100).toFixed(1)}%</td>
        `;
        tableBody.appendChild(tr);
      }
    }
    renderHistory();

    // ---- Graphique R√©sultats (Sain / Surpoids / Ob√®se) ----
    const counts = predictions.reduce((acc, p) => {
      acc[p.result] = (acc[p.result] || 0) + 1;
      return acc;
    }, {});

    new Chart(document.getElementById("chartResults"), {
      type: "pie",
      data: {
        labels: Object.keys(counts),
        datasets: [{
          data: Object.values(counts),
          backgroundColor: ["#4CAF50", "#FF9800", "#F44336"]
        }]
      },
      options: {
        plugins: { title: { display: true, text: "R√©partition des R√©sultats" } }
      }
    });

    // ---- Graphique Probabilit√©s (√©volution dans le temps) ----
    new Chart(document.getElementById("chartProbabilities"), {
      type: "line",
      data: {
        labels: predictions.map(p => p.date),
        datasets: [{
          label: "Probabilit√© pr√©dite",
          data: predictions.map(p => (p.probability * 100).toFixed(1)),
          borderColor: "#2196F3",
          fill: false,
          tension: 0.2
        }]
      },
      options: {
        plugins: { title: { display: true, text: "√âvolution des Probabilit√©s (%)" } },
        scales: { y: { min: 0, max: 100 } }
      }
    });
  </script>
</body>


  <script src="js/app.js"></script>
</body>

</html>