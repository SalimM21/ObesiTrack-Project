<!DOCTYPE html>
<html>
<head>
  <title>Prédiction ObesiTrack</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
  <h1>Soumettre vos données</h1>
  <form id="predict-form">
    <input type="number" name="age" placeholder="Âge" required>
    <input type="number" name="height" placeholder="Taille (cm)" required>
    <input type="number" name="weight" placeholder="Poids (kg)" required>
    <!-- Ajouter autres champs FCVC, FAF, etc. -->
    <button type="submit">Prédire</button>
  </form>

  <h2>Résultat : <span id="label"></span></h2>
  <canvas id="probChart" width="400" height="200"></canvas>

  <script>
    const form = document.getElementById('predict-form');
    form.addEventListener('submit', async (e) => {
      e.preventDefault();
      const data = Object.fromEntries(new FormData(form));
      const res = await fetch('/predict', {
        method: 'POST',
        headers: { 
          'Content-Type': 'application/json',
          'Authorization': 'Bearer ' + localStorage.getItem('jwt')
        },
        body: JSON.stringify(data)
      });
      const result = await res.json();
      document.getElementById('label').textContent = result.label;

      const ctx = document.getElementById('probChart').getContext('2d');
      new Chart(ctx, {
        type: 'bar',
        data: {
          labels: Object.keys(result.probabilities),
          datasets: [{
            label: 'Probabilités',
            data: Object.values(result.probabilities),
            backgroundColor: 'rgba(75, 192, 192, 0.6)'
          }]
        },
        options: { scales: { y: { beginAtZero: true } } }
      });
    });
  </script>
</body>
</html>
